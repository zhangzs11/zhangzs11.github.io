<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>3D Mathematics-Basic | Canned Pixels</title><meta name="author" content="Zishuai Zhang,zhangzs2023@163.com"><meta name="copyright" content="Zishuai Zhang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Dot productThe dot product is a mathematical operation that takes two vectors and return a scalar. It is calculated as the sum of the products of their corresponding components, or geometrically as th">
<meta property="og:type" content="article">
<meta property="og:title" content="3D Mathematics-Basic">
<meta property="og:url" content="https://zhangzs11.github.io/2022/12/12/3D_Mathematics/index.html">
<meta property="og:site_name" content="Canned Pixels">
<meta property="og:description" content="Dot productThe dot product is a mathematical operation that takes two vectors and return a scalar. It is calculated as the sum of the products of their corresponding components, or geometrically as th">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zhangzs11.github.io/img/MyAvatar.jpg">
<meta property="article:published_time" content="2022-12-12T07:00:00.000Z">
<meta property="article:modified_time" content="2025-02-02T23:30:05.643Z">
<meta property="article:author" content="Zishuai Zhang">
<meta property="article:tag" content="Computer Graphics, D3D, Game Engine Development">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhangzs11.github.io/img/MyAvatar.jpg"><link rel="shortcut icon" href="/img/MyAvatar.jpg"><link rel="canonical" href="https://zhangzs11.github.io/2022/12/12/3D_Mathematics/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '3D Mathematics-Basic',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background: linear-gradient(20deg, #b9fbc0, #98f5e1, #90dbf4, #cfbaf0);"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/Funny/doc_room_pixel.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Canned Pixels</span></a><a class="nav-page-title" href="/"><span class="site-name">3D Mathematics-Basic</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">3D Mathematics-Basic<a class="post-edit-link" href="null_posts/3D_Mathematics.md" title="Edit" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-12-12T07:00:00.000Z" title="Created 2022-12-12 00:00:00">2022-12-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-02-02T23:30:05.643Z" title="Updated 2025-02-02 16:30:05">2025-02-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Compute-Graphics/">Compute Graphics</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Dot-product"><a href="#Dot-product" class="headerlink" title="Dot product"></a>Dot product</h1><p>The dot product is a mathematical operation that takes two vectors and return a scalar. It is calculated as the sum of the products of their corresponding components, or geometrically as the product of their magnitudes and the cosine of the angle between them.<br>It is often used to determine angles between vectors, project one vector onto another, like calculate lighting in computer graphics.</p>
<h1 id="Cross-product"><a href="#Cross-product" class="headerlink" title="Cross product"></a>Cross product</h1><p>The cross product is a mathematical operation that takes two 3D vectors and returns a new vector that is perpendicular to both input vector. Its magnitude equals the area of the parallelogram formed by the two vectors.<br>It is used for calculating normals to surfaces or determining directions.</p>
<h1 id="Eular-gimbal-lock"><a href="#Eular-gimbal-lock" class="headerlink" title="Eular (gimbal lock)"></a>Eular (gimbal lock)</h1><h1 id="Why-use-quaternions-over-Euler-angles"><a href="#Why-use-quaternions-over-Euler-angles" class="headerlink" title="Why use quaternions over Euler angles"></a>Why use quaternions over Euler angles</h1><h1 id="Homogeneous-Coordinates"><a href="#Homogeneous-Coordinates" class="headerlink" title="Homogeneous Coordinates"></a>Homogeneous Coordinates</h1><p>In 3D Homogeneous Coordinate system like, <script type="math/tex">[x, y, z, 1]</script>, But Why bother with extra component?</p>
<h2 id="Translation-with-Matrix"><a href="#Translation-with-Matrix" class="headerlink" title="Translation with Matrix"></a>Translation with Matrix</h2><p>When we need move(translation) the object from its origin, normal matrix can’t do that. The solution is sum translation vector.<br>A more convenient approach <strong>involves adding a coordinate set to one</strong>, and incorporating a new column and row into the multiplied Matrix.<br>More convenient, you can put all your transformation in a single Matrix, make a substantial difference for performance.</p>
<h2 id="Disable-the-ability-to-Translate"><a href="#Disable-the-ability-to-Translate" class="headerlink" title="Disable the ability to Translate"></a>Disable the ability to Translate</h2><p>By setting its last coordinate(w) to zero, the object gets locked in place.<br>We reserve this treatment for vectors that represent Direction because translating them with W will changes their orientation and magnitude, which is not the intended behavior.<br>We typically see this kind of vector used for light direction or normal vectors (they only present the direction). </p>
<h2 id="Self-division-for-perspective"><a href="#Self-division-for-perspective" class="headerlink" title="Self division for perspective"></a>Self division for perspective</h2><p>There is a <em>RULE in Rendering Pipeline</em>, <strong>is to divide every component of the vector by the homogeneous coordinate(w) to retrieve the original Vector</strong>, bring the homogeneous value back to one while rescaling the other components.<br>SO In Perspective Projection:<br>Because we need to downside objects proportionally to their distance to the viewer, we simply divide the X, Y, Z component by their distance from the camera plane. The <strong>distance</strong> is often represented by the <strong>Z coordinate (left-hand coordinate)</strong>, or the <strong>negative Z if the camera is looking toward negative Z (in right-hand coordinate, and the reason it’s the negative Z, in the view space for the right-handed coordinate system, the Z-axis points outward from the camera along the negative Z direction. Since w represents the distance from the the camera to the point, uses -z to ensure a positive value)</strong>. This division can be geometrically illustrated as a 3D scene where you project the field of view, where is a pyramidal frustum into rectangular prism. And then we neutralize the Z component to project on Screen.<br>So if we look the transformation matrix used for perspective projection, the matrix will result in Z being the homogeneous value ( w = z), because x, y, z, after scale and transform will have to divided by w, what we want is divided by z (-z)</p>
<h1 id="Space-Transformations"><a href="#Space-Transformations" class="headerlink" title="Space Transformations"></a>Space Transformations</h1><p>The process of spatial transformations for an object is as follows:<br><strong>Local Space -&gt; World Space -&gt; View Space -&gt; Homogeneous Clip Space -&gt; Normalized Device Coordinates (NDC)</strong><br>These operations correspond to the following transformation:</p>
<ul>
<li><strong>World Matrix Transformation</strong> (Local to World Space)</li>
<li><strong>View Matrix Transformation</strong> (World to View Space)</li>
<li><strong>Projection Matrix Transformation</strong> (View to Clip Space)</li>
<li><strong>Perspective Division</strong> (Divide by w, Clip Space to NDC)</li>
</ul>
<h2 id="Adjustments-for-Converting-Right-Handed-to-Left-Handed-Coordinate-Systems-in-Direct3D"><a href="#Adjustments-for-Converting-Right-Handed-to-Left-Handed-Coordinate-Systems-in-Direct3D" class="headerlink" title="Adjustments for Converting Right-Handed to Left-Handed Coordinate Systems in Direct3D"></a>Adjustments for Converting Right-Handed to Left-Handed Coordinate Systems in Direct3D</h2><p>Direct3D uses a left-handed coordinate system. To port an application based on a right-handed coordinate system to D3D, two key changes must be made to the data passed to Direct3D:</p>
<ol>
<li>Reverse the Order of Triangle Vertices<br> Adjust the triangle’s vertex order so that the system interprets them as the front-face or back-face we expect. For example, if the original order is v0, v1, v2, pass the vertices to D3D as v0, v2, v1</li>
<li>Flip the Z-Axis in the View ( OR Projection, what I do in my engine, in view space the Z still negative, <strong>in Clip Space, which is just the Vertex shader output, start become positive</strong>) Matrix<br> Scale Z-axis by -1 in the View (or Projection) Matrix. This can be achieved by negating all the coefficients related to the Z-axis, specifically the _31, _32, _33, and _34 elements of the D3DMATRIX structure.<h2 id="In-D3D-NDC-space"><a href="#In-D3D-NDC-space" class="headerlink" title="In D3D NDC space"></a>In D3D NDC space</h2>far plane z must be 1 (same 1 in openGL). near plane z must be 0, (-1 in openGL)</li>
</ol>
<h1 id="How-do-you-calculate-the-intersection-between-a-ray-and-a-plane-sphere-triangle"><a href="#How-do-you-calculate-the-intersection-between-a-ray-and-a-plane-sphere-triangle" class="headerlink" title="How do you calculate the intersection between a ray and a plane/sphere/triangle?"></a>How do you calculate the intersection between a ray and a plane/sphere/triangle?</h1><p>This function computes the point $ P(t) $ on the parametric equation of a line when the parameter is t, where</p>
<script type="math/tex; mode=display">
P(t) = \mathbf{l_0} + t \times \mathbf{l}</script><p>It’s used for calculating the intersection point <strong><em>(hit point)</em></strong> between a ray and an object during ray-object intersection testing.</p>
<h2 id="Ray-Plane-intersection"><a href="#Ray-Plane-intersection" class="headerlink" title="Ray-Plane intersection"></a>Ray-Plane intersection</h2><h3 id="The-equation-of-a-Plane"><a href="#The-equation-of-a-Plane" class="headerlink" title="The equation of a Plane"></a>The equation of a Plane</h3><script type="math/tex; mode=display">
\text{Dot}((\mathbf{p} - \mathbf{p_0}), \mathbf{n}) = 0</script><p>Where:</p>
<ul>
<li>$ \mathbf{p} $ is a point on the sphere</li>
<li>$ \mathbf{p_0} $ is any reference point on the plane, does not have to be a specific point</li>
<li>$ n $ is the normal vector of the plane</li>
</ul>
<h3 id="Combining-the-Ray-and-Plane-Equations"><a href="#Combining-the-Ray-and-Plane-Equations" class="headerlink" title="Combining the Ray and Plane Equations"></a>Combining the Ray and Plane Equations</h3><p>To find the intersection, substitute the ray’s parametric equation $ P(t) $ into the plane’s equation</p>
<script type="math/tex; mode=display">
\text{Dot}((\mathbf{l_0} + t \cdot \mathbf{l} - \mathbf{p_0}), \mathbf{n}) = 0</script><p>Expanding:</p>
<script type="math/tex; mode=display">
\text{Dot}((\mathbf{l_0} - \mathbf{p_0}), \mathbf{n}) + t \cdot \text{Dot}(\mathbf{l}, \mathbf{n}) = 0</script><p>This simplifies to:</p>
<script type="math/tex; mode=display">
t = \frac{\text{Dot}((\mathbf{p_0} - \mathbf{l_0}), \mathbf{n})}{\text{Dot}(\mathbf{l}, \mathbf{n})}</script><p>It’s worth noting that if the plane and ray are parallel (i.e, when $\text{Dot}(l, n)$ approaches 0), they either perfectly coincide, offering an infinite number of solutions, or they do not intersect at all. In pratical C++ implementations, we return false when the denominator is less than a very small threshold<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">intersectPlane</span><span class="params">(<span class="type">const</span> Vec3f &amp;n, <span class="type">const</span> Vec3f &amp;p0, <span class="type">const</span> Vec3f &amp;l0, <span class="type">const</span> Vec3f &amp;l, <span class="type">float</span> &amp;t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Assuming vectors are all normalized</span></span><br><span class="line">    <span class="type">float</span> denom = <span class="built_in">dotProduct</span>(n, l);</span><br><span class="line">    <span class="keyword">if</span> (denom &gt; <span class="number">1e-6</span>) &#123;</span><br><span class="line">        Vec3f p0l0 = p0 - l0;</span><br><span class="line">        t = <span class="built_in">dotProduct</span>(p0l0, n) / denom; </span><br><span class="line">        <span class="keyword">return</span> (t &gt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Extend-Ray-Disk-intersection"><a href="#Extend-Ray-Disk-intersection" class="headerlink" title="Extend Ray-Disk intersection"></a>Extend Ray-Disk intersection</h3><p>A disk is defined by its position (the center of the disk), a normal, a radius. The initial step involves checking if the ray intersects the plane where the disk resides. If there is an intersection with the plane, the next step is to calculate the intersection point and measure the distance from this point to the disk center. The ray intersects the disk if this distance is less than or equal to the disk’s radius.</p>
<h2 id="Ray-Sphere-intersection"><a href="#Ray-Sphere-intersection" class="headerlink" title="Ray-Sphere intersection"></a>Ray-Sphere intersection</h2><h3 id="The-equation-of-a-Sphere"><a href="#The-equation-of-a-Sphere" class="headerlink" title="The equation of a Sphere"></a>The equation of a Sphere</h3><script type="math/tex; mode=display">
\text{Dot}((\mathbf{p} - \mathbf{c}), (\mathbf{p} - \mathbf{c})) = R^2</script><p>Where:</p>
<ul>
<li>$ \mathbf{p} $ is a point on the sphere,</li>
<li>$ \mathbf{c} $ is the center of the sphere, and</li>
<li>$ R $ is the radius of the sphere.</li>
</ul>
<h3 id="Combining-the-Ray-and-Sphere-Equations"><a href="#Combining-the-Ray-and-Sphere-Equations" class="headerlink" title="Combining the Ray and Sphere Equations"></a>Combining the Ray and Sphere Equations</h3><p>If a ray hits the sphere, there is some $ t $ for which $ \mathbf{p}(t) $ satisfies the sphere equation. This leads us to the following equation for any $ t $:</p>
<script type="math/tex; mode=display">
\text{Dot}((\mathbf{P}(t) - \mathbf{c}), (\mathbf{P}(t) - \mathbf{c})) = R^2</script><p>Expanding this equation and rearranging the terms, we get the following quadratic form:</p>
<script type="math/tex; mode=display">
t^2 \cdot \text{Dot}(\mathbf{l}, \mathbf{l}) + 2t \cdot \text{Dot}(\mathbf{l}, \mathbf{l_0} - \mathbf{C}) + \text{Dot}(\mathbf{l_0} - \mathbf{C}, \mathbf{l_0} - \mathbf{C}) - R^2 = 0</script><p>(Since the dot product obeys the distributive and commutative properties.)</p>
<p>Here, the unknown is $ t $, and the equation is <strong>quadratic</strong>. We can solve for $ t $, and the part <strong>involving the square root will determine how many real solutions exist</strong>, indicating whether the ray <strong>hits</strong> the sphere and <strong>how many intersection points</strong> there are.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">sphere::hit</span><span class="params">(<span class="type">const</span> ray&amp; r, <span class="type">float</span> t_min, <span class="type">float</span> t_max, hit_record&amp; rec)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    vec3 oc = r.<span class="built_in">origin</span>() - center;</span><br><span class="line">    <span class="type">float</span> a = <span class="built_in">dot</span>(r.<span class="built_in">direction</span>(), r.<span class="built_in">direction</span>());</span><br><span class="line">    <span class="type">float</span> b = <span class="built_in">dot</span>(oc, r.<span class="built_in">direction</span>());</span><br><span class="line">    <span class="type">float</span> c = <span class="built_in">dot</span>(oc, oc) - radius * radius;</span><br><span class="line">    <span class="type">float</span> discriminant = b * b - a * c;</span><br><span class="line">    <span class="keyword">if</span> (discriminant &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">float</span> temp = (-b - <span class="built_in">sqrt</span>(discriminant)) / a;</span><br><span class="line">        <span class="keyword">if</span> (temp &lt; t_max &amp;&amp; temp &gt; t_min) &#123;</span><br><span class="line">            rec.t = temp;</span><br><span class="line">            rec.p = r.<span class="built_in">point_at_parameter</span>(rec.t);</span><br><span class="line">            rec.normal = (rec.p - center) / radius;</span><br><span class="line">            rec.mat_ptr = mat_ptr;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        temp = (-b + <span class="built_in">sqrt</span>(discriminant)) / a;</span><br><span class="line">        <span class="keyword">if</span> (temp &lt; t_max &amp;&amp; temp &gt; t_min) &#123;</span><br><span class="line">            rec.t = temp;</span><br><span class="line">            rec.p = r.<span class="built_in">point_at_parameter</span>(rec.t);</span><br><span class="line">            rec.normal = (rec.p - center) / radius;</span><br><span class="line">            rec.mat_ptr = mat_ptr;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ray-Triangle-intersection"><a href="#Ray-Triangle-intersection" class="headerlink" title="Ray-Triangle intersection"></a>Ray-Triangle intersection</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://zhangzs11.github.io">Zishuai Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://zhangzs11.github.io/2022/12/12/3D_Mathematics/">https://zhangzs11.github.io/2022/12/12/3D_Mathematics/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/MyAvatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2022/12/16/CPP-vtable/" title="CPP-vtable"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">CPP-vtable</div></div><div class="info-2"><div class="info-item-1">vtablecode example12345678910111213141516171819202122232425262728293031323334class Base &#123;    public:        Base() &#123;            cout &lt;&lt; &quot;Base Constructor&quot;        &#125;        virtual ~Base() &#123;            cout &lt;&lt; &quot;Base Destructor&quot;        &#125;        virtual void MemberFunc() &#123;            cout &lt;&lt; &quot;Base::MemberFunc()&quot;        &#125;&#125;;class Derived : public Base &#123;    public:        Derived() &#123;            cout...</div></div></div></a><a class="pagination-related" href="/2022/11/17/CPP-1114Features/" title="CPP-Cpp11/14 Features"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">CPP-Cpp11/14 Features</div></div><div class="info-2"><div class="info-item-1">AutoIn cpp11 it is possible now to declare a variable with the keyword Auto instead of using the concrete type.During development time which the studio is able to determine the correct type for intellisense reference is also possible with the auto specifier, just use the ampersand behind the auto1auto&amp; p = persons[1]; Range based for loopsupported by all container types of SDL like vectors. Instead of using this complicated syntax below with the iterator1234for...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/MyAvatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Zishuai Zhang</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/zhangzs11" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:zhangzs2023@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Dot-product"><span class="toc-number">1.</span> <span class="toc-text">Dot product</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cross-product"><span class="toc-number">2.</span> <span class="toc-text">Cross product</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Eular-gimbal-lock"><span class="toc-number">3.</span> <span class="toc-text">Eular (gimbal lock)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Why-use-quaternions-over-Euler-angles"><span class="toc-number">4.</span> <span class="toc-text">Why use quaternions over Euler angles</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Homogeneous-Coordinates"><span class="toc-number">5.</span> <span class="toc-text">Homogeneous Coordinates</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Translation-with-Matrix"><span class="toc-number">5.1.</span> <span class="toc-text">Translation with Matrix</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Disable-the-ability-to-Translate"><span class="toc-number">5.2.</span> <span class="toc-text">Disable the ability to Translate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Self-division-for-perspective"><span class="toc-number">5.3.</span> <span class="toc-text">Self division for perspective</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Space-Transformations"><span class="toc-number">6.</span> <span class="toc-text">Space Transformations</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Adjustments-for-Converting-Right-Handed-to-Left-Handed-Coordinate-Systems-in-Direct3D"><span class="toc-number">6.1.</span> <span class="toc-text">Adjustments for Converting Right-Handed to Left-Handed Coordinate Systems in Direct3D</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#In-D3D-NDC-space"><span class="toc-number">6.2.</span> <span class="toc-text">In D3D NDC space</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-do-you-calculate-the-intersection-between-a-ray-and-a-plane-sphere-triangle"><span class="toc-number">7.</span> <span class="toc-text">How do you calculate the intersection between a ray and a plane&#x2F;sphere&#x2F;triangle?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ray-Plane-intersection"><span class="toc-number">7.1.</span> <span class="toc-text">Ray-Plane intersection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-equation-of-a-Plane"><span class="toc-number">7.1.1.</span> <span class="toc-text">The equation of a Plane</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Combining-the-Ray-and-Plane-Equations"><span class="toc-number">7.1.2.</span> <span class="toc-text">Combining the Ray and Plane Equations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Extend-Ray-Disk-intersection"><span class="toc-number">7.1.3.</span> <span class="toc-text">Extend Ray-Disk intersection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ray-Sphere-intersection"><span class="toc-number">7.2.</span> <span class="toc-text">Ray-Sphere intersection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-equation-of-a-Sphere"><span class="toc-number">7.2.1.</span> <span class="toc-text">The equation of a Sphere</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Combining-the-Ray-and-Sphere-Equations"><span class="toc-number">7.2.2.</span> <span class="toc-text">Combining the Ray and Sphere Equations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ray-Triangle-intersection"><span class="toc-number">7.3.</span> <span class="toc-text">Ray-Triangle intersection</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/20/GraphicsSystem-DeferredRendering/" title="GraphicsSystem-Deferred Rendering">GraphicsSystem-Deferred Rendering</a><time datetime="2025-01-20T21:05:08.640Z" title="Created 2025-01-20 14:05:08">2025-01-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/18/GraphicsSystem-FXAA/" title="GraphicsSystem-FXAA">GraphicsSystem-FXAA</a><time datetime="2025-01-19T05:19:14.585Z" title="Created 2025-01-18 22:19:14">2025-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/18/GraphicsSystem-NormalMapping/" title="GraphicsSystem-Normal Mapping">GraphicsSystem-Normal Mapping</a><time datetime="2025-01-18T18:19:54.862Z" title="Created 2025-01-18 11:19:54">2025-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/18/GraphicsSystem-Skybox/" title="GraphicsSystem-Skybox">GraphicsSystem-Skybox</a><time datetime="2025-01-18T18:19:22.199Z" title="Created 2025-01-18 11:19:22">2025-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/16/Graphics_System-Shadow/" title="GraphicsSystem-Shadow Mapping">GraphicsSystem-Shadow Mapping</a><time datetime="2024-12-16T07:00:00.000Z" title="Created 2024-12-16 00:00:00">2024-12-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Zishuai Zhang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>